trigger:
- master

pool:
  vmImage: 'windows-latest'

variables:
  solution: '**/*.sln'
  buildPlatform: 'Any CPU'
  buildConfiguration: 'Release'

stages:
- stage: Build
  displayName: Build Stage  
  jobs: 
  - job: Build
    displayName: Build Job
    steps:
    - task: NuGetToolInstaller@1

    - task: DotNetCoreInstaller@0
      displayName: 'Use .NET Core sdk 3.1.101'
      inputs:
        version: 3.1.101

    - task: DotNetCoreCLI@2
      displayName: dotnet restore
      inputs:
        command: restore
      inputs:
        restoreSolution: '$(solution)'

    - task: DotNetCoreCLI@2
      displayName: Build
      inputs:
        projects: '**/*.sln'
        arguments: '--configuration $(BuildConfiguration) --no-restore'
    
    - task: DotNetCoreCLI@2
      inputs:
        command: test
        projects: '**/*Test/*.csproj'
        arguments: '--configuration $(buildConfiguration)'
